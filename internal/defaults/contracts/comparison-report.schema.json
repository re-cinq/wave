{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "description": "Comparative analysis between current and historical analytics periods",
  "required": [
    "summary",
    "metric_changes",
    "trends",
    "anomalies",
    "page_performance",
    "traffic_analysis",
    "key_insights"
  ],
  "properties": {
    "summary": {
      "type": "object",
      "description": "High-level comparison findings",
      "required": [
        "overall_trend",
        "primary_finding"
      ],
      "properties": {
        "overall_trend": {
          "type": "string",
          "enum": [
            "improving",
            "declining",
            "stable",
            "mixed"
          ],
          "description": "Overall trajectory direction"
        },
        "primary_finding": {
          "type": "string",
          "description": "Most significant finding from the comparison"
        },
        "confidence_level": {
          "type": "string",
          "enum": [
            "high",
            "medium",
            "low"
          ],
          "description": "Confidence in the analysis"
        }
      }
    },
    "metric_changes": {
      "type": "array",
      "description": "Detailed metric-by-metric comparison",
      "items": {
        "type": "object",
        "required": [
          "metric_name",
          "current_value",
          "historical_value",
          "change_percent"
        ],
        "properties": {
          "metric_name": {
            "type": "string",
            "description": "Name of the metric"
          },
          "current_value": {
            "type": "number",
            "description": "Value in current period"
          },
          "historical_value": {
            "type": "number",
            "description": "Value in historical period"
          },
          "change_percent": {
            "type": "number",
            "description": "Percentage change (positive = increase)"
          },
          "significance": {
            "type": "string",
            "enum": [
              "critical",
              "significant",
              "moderate",
              "minor"
            ],
            "description": "Significance level of the change"
          }
        }
      }
    },
    "trends": {
      "type": "array",
      "description": "Identified trends in the data",
      "items": {
        "type": "object",
        "required": [
          "name",
          "direction",
          "description"
        ],
        "properties": {
          "name": {
            "type": "string",
            "description": "Trend identifier"
          },
          "direction": {
            "type": "string",
            "enum": [
              "up",
              "down",
              "stable",
              "volatile"
            ],
            "description": "Trend direction"
          },
          "description": {
            "type": "string",
            "description": "Detailed description of the trend"
          },
          "affected_metrics": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Metrics affected by this trend"
          }
        }
      }
    },
    "anomalies": {
      "type": "array",
      "description": "Unusual patterns or outliers detected",
      "items": {
        "type": "object",
        "required": [
          "type",
          "description"
        ],
        "properties": {
          "type": {
            "type": "string",
            "description": "Type of anomaly"
          },
          "description": {
            "type": "string",
            "description": "Description of the anomaly"
          },
          "date_range": {
            "type": "string",
            "description": "When the anomaly occurred"
          },
          "possible_cause": {
            "type": "string",
            "description": "Hypothesized cause"
          }
        }
      }
    },
    "page_performance": {
      "type": "object",
      "description": "Page-level performance changes",
      "required": [
        "winners",
        "losers"
      ],
      "properties": {
        "winners": {
          "type": "array",
          "description": "Pages with improved performance",
          "items": {
            "type": "object",
            "required": [
              "path",
              "change_percent"
            ],
            "properties": {
              "path": {
                "type": "string",
                "description": "Page path"
              },
              "change_percent": {
                "type": "number",
                "description": "Percentage improvement"
              },
              "reason": {
                "type": "string",
                "description": "Possible reason for improvement"
              }
            }
          }
        },
        "losers": {
          "type": "array",
          "description": "Pages with declined performance",
          "items": {
            "type": "object",
            "required": [
              "path",
              "change_percent"
            ],
            "properties": {
              "path": {
                "type": "string",
                "description": "Page path"
              },
              "change_percent": {
                "type": "number",
                "description": "Percentage decline (negative number)"
              },
              "reason": {
                "type": "string",
                "description": "Possible reason for decline"
              }
            }
          }
        }
      }
    },
    "traffic_analysis": {
      "type": "object",
      "description": "Analysis of traffic source changes",
      "properties": {
        "growing_sources": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "source": {
                "type": "string"
              },
              "growth_percent": {
                "type": "number"
              }
            }
          }
        },
        "declining_sources": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "source": {
                "type": "string"
              },
              "decline_percent": {
                "type": "number"
              }
            }
          }
        },
        "new_sources": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "lost_sources": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "key_insights": {
      "type": "array",
      "description": "Actionable insights derived from the analysis",
      "items": {
        "type": "string"
      }
    }
  }
}