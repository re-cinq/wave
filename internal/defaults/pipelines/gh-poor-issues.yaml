kind: WavePipeline
metadata:
    name: github-issues-enhancement-pipeline
    description: Pipeline to scan, list, and enhance poorly described GitHub issues
input:
    source: meta
steps:
    - id: navigate
      persona: navigator
      memory:
        strategy: fresh
      workspace:
        root: ./
      exec:
        type: prompt
        source: 'Analyze the task: {{ input }}. Identify GitHub repositories to scan, issue criteria for ''poorly described'', and enhancement strategies. Map out the issue scanning and enhancement workflow.'
      handover:
        contract:
            type: json_schema
            schema_path: .wave/contracts/issue-analysis.schema.json
    - id: scan-issues
      persona: implementer
      dependencies:
        - navigate
      memory:
        strategy: fresh
        inject_artifacts:
            - step: navigate
              artifact: analysis
              as: context
      workspace:
        root: ./
      exec:
        type: prompt
        source: Based on the navigation analysis, scan GitHub repositories for project-related issues. List all issues and categorize them by quality of description using the criteria from the analysis.
      handover:
        contract:
            type: json_schema
            schema_path: .wave/contracts/issue-scan.schema.json
    - id: identify-poor-issues
      persona: philosopher
      dependencies:
        - scan-issues
      memory:
        strategy: fresh
        inject_artifacts:
            - step: navigate
              artifact: analysis
              as: context
            - step: scan-issues
              artifact: issue-list
              as: scanned-issues
      workspace:
        root: ./
      exec:
        type: prompt
        source: Analyze the scanned issues to identify those that are poorly described. Create detailed specifications for how to enhance each poorly described issue, including missing information, clarity improvements, and structured formatting.
      handover:
        contract:
            type: json_schema
            schema_path: .wave/contracts/enhancement-plan.schema.json
    - id: enhance-issues
      persona: implementer
      dependencies:
        - identify-poor-issues
      memory:
        strategy: fresh
        inject_artifacts:
            - step: identify-poor-issues
              artifact: enhancement-plan
              as: plan
      workspace:
        root: ./
      exec:
        type: prompt
        source: Execute the enhancement plan by updating poorly described GitHub issues with improved descriptions, following the specifications from the philosopher step.
      handover:
        contract:
            type: json_schema
            schema_path: .wave/contracts/enhancement-results.schema.json
    - id: review
      persona: reviewer
      dependencies:
        - enhance-issues
      memory:
        strategy: fresh
        inject_artifacts:
            - step: enhance-issues
              artifact: results
              as: enhancement-results
      workspace:
        root: ./
      exec:
        type: prompt
        source: Review the issue enhancement results for quality, completeness, and adherence to GitHub best practices. Provide a summary report of improvements made.
      handover:
        contract:
            type: json_schema
            schema_path: .wave/contracts/review-report.schema.json
